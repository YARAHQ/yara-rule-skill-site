<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#0a0a0a">
    <title>YARA Rule Skill</title>
    <style>
        :root {
            --bg: #0a0a0a;
            --bg-dim: #111111;
            --bg-bright: #1a1a1a;
            --fg: #e0e0e0;
            --fg-dim: #808080;
            --accent: #f4d03f;
            --accent-dim: #b8a030;
            --green: #4ade80;
            --red: #f87171;
            --blue: #60a5fa;
            --orange: #fb923c;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            color-scheme: dark;
        }

        body {
            font-family: 'JetBrains Mono', 'Fira Code', 'SF Mono', 'Consolas', monospace;
            background-color: var(--bg);
            color: var(--fg);
            line-height: 1.6;
            font-size: 14px;
            padding: 2rem 1rem;
        }

        @media (min-width: 640px) {
            body {
                padding: 3rem 2rem;
                font-size: 15px;
            }
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
        }

        /* Header Box */
        .header-box {
            border: 1px solid var(--accent-dim);
            padding: 1.5rem;
            margin-bottom: 2rem;
            background: var(--bg-dim);
        }

        .header-box h1 {
            color: var(--accent);
            font-size: 1.25rem;
            font-weight: normal;
            margin-bottom: 0.5rem;
        }

        .header-box h1::before {
            content: "▶ ";
        }

        .header-box p {
            color: var(--fg-dim);
            font-size: 0.9rem;
        }

        /* Section Boxes */
        .box {
            border: 1px solid var(--fg-dim);
            margin-bottom: 1.5rem;
            background: var(--bg-dim);
        }

        .box-header {
            background: var(--bg-bright);
            padding: 0.5rem 1rem;
            border-bottom: 1px solid var(--fg-dim);
            color: var(--accent);
            font-weight: bold;
        }

        .box-content {
            padding: 1rem;
        }

        /* Use Cases */
        .use-case {
            margin-bottom: 1.5rem;
            padding-left: 1rem;
            border-left: 2px solid var(--accent-dim);
        }

        .use-case:last-child {
            margin-bottom: 0;
        }

        .use-case h3 {
            color: var(--accent);
            font-size: 1rem;
            margin-bottom: 0.5rem;
        }

        .use-case h3::before {
            content: "[>] ";
            color: var(--green);
        }

        .use-case p {
            color: var(--fg-dim);
            margin-bottom: 0.5rem;
        }

        .example {
            color: var(--fg);
            background: var(--bg);
            padding: 0.5rem 0.75rem;
            margin-top: 0.5rem;
            font-size: 0.85rem;
            border-left: 2px solid var(--green);
        }

        .example::before {
            content: "$ ";
            color: var(--green);
        }

        /* Code Blocks */
        pre {
            background: var(--bg);
            padding: 1rem;
            overflow-x: auto;
            font-size: 0.85rem;
            line-height: 1.5;
            margin: 1rem 0;
            border: 1px solid var(--fg-dim);
        }

        code {
            font-family: inherit;
        }

        .comment { color: var(--fg-dim); }
        .keyword { color: var(--blue); }
        .string { color: var(--green); }
        .variable { color: var(--orange); }

        /* Features */
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 1rem;
        }

        .feature-item {
            padding: 0.75rem;
            background: var(--bg);
            border-left: 2px solid var(--accent-dim);
        }

        .feature-item h4 {
            color: var(--accent);
            font-size: 0.9rem;
            margin-bottom: 0.25rem;
        }

        .feature-item h4::before {
            content: "[*] ";
            color: var(--blue);
        }

        .feature-item p {
            color: var(--fg-dim);
            font-size: 0.85rem;
        }

        /* Checks */
        .check-list {
            margin: 0;
            padding: 0;
            list-style: none;
        }

        .check-item {
            padding: 0.4rem 0;
            border-bottom: 1px solid var(--bg-bright);
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .check-item:last-child {
            border-bottom: none;
        }

        .check-tag {
            padding: 0.1rem 0.4rem;
            font-size: 0.75rem;
            font-weight: bold;
            min-width: 3rem;
            text-align: center;
        }

        .tag-logic { background: var(--red); color: var(--bg); }
        .tag-perf { background: var(--orange); color: var(--bg); }
        .tag-style { background: var(--blue); color: var(--bg); }
        .tag-res { background: var(--green); color: var(--bg); }

        .check-desc {
            color: var(--fg-dim);
            font-size: 0.9rem;
        }

        .check-desc code {
            color: var(--fg);
            background: var(--bg-bright);
            padding: 0.1rem 0.3rem;
            font-size: 0.85rem;
        }

        h4.section-subtitle {
            color: var(--fg);
            margin: 1rem 0 0.5rem;
            font-size: 0.95rem;
        }

        h4.section-subtitle::before {
            content: "-- ";
            color: var(--accent-dim);
        }

        /* Example Issues */
        .issue {
            margin: 1rem 0;
            padding: 0.75rem;
            background: var(--bg);
            border-left: 3px solid var(--red);
        }

        .issue strong {
            color: var(--red);
        }

        .issue strong::before {
            content: "[!] ";
        }

        .fix {
            margin: 0.5rem 0 0;
            padding: 0.5rem;
            background: var(--bg-bright);
            border-left: 3px solid var(--green);
        }

        .fix strong {
            color: var(--green);
        }

        .fix strong::before {
            content: "[✓] ";
        }

        /* Install */
        .install-command {
            background: var(--bg);
            padding: 1rem;
            margin: 1rem 0;
            font-size: 0.85rem;
            border: 1px solid var(--fg-dim);
        }

        .install-command .comment {
            color: var(--fg-dim);
        }

        .install-command .prompt::before {
            content: "$ ";
            color: var(--green);
        }

        /* Links */
        a {
            color: var(--accent);
            text-decoration: none;
        }

        a:hover {
            text-decoration: underline;
        }

        a::before {
            content: "[link] ";
            color: var(--fg-dim);
            font-size: 0.85rem;
        }

        /* Footer */
        footer {
            margin-top: 2rem;
            padding-top: 1rem;
            border-top: 1px solid var(--fg-dim);
            color: var(--fg-dim);
            font-size: 0.85rem;
        }

        footer p {
            margin-bottom: 0.5rem;
        }

        /* Reduced motion */
        @media (prefers-reduced-motion: reduce) {
            * {
                animation: none !important;
                transition: none !important;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header-box">
            <h1>YARA_RULE_SKILL</h1>
            <p>An LLM Agent Skill that embeds expert YARA knowledge into your AI assistant.<br>
            Get professional rule reviews, performance optimization, and quality checks—just by asking.</p>
        </div>

        <div class="box">
            <div class="box-header">HOW_IT_WORKS</div>
            <div class="box-content">
                <p style="color: var(--fg-dim); margin-bottom: 1rem;">Add the skill to your LLM agent's context, then simply ask.</p>
                
                <div class="use-case">
                    <h3>Review Your Rules</h3>
                    <p>Paste a rule you're writing and get instant expert feedback. Checks naming conventions, string atoms, condition logic, and metadata.</p>
                    <div class="example">"Review this YARA rule and suggest improvements"</div>
                </div>

                <div class="use-case">
                    <h3>Evaluate Public Rules</h3>
                    <p>Before deploying a rule from GitHub, paste it and ask for assessment. All 20+ yaraQA checks applied automatically.</p>
                    <div class="example">"Assess the quality of this rule I found online"</div>
                </div>

                <div class="use-case">
                    <h3>Debug Performance</h3>
                    <p>Slow scans? Paste the rule and ask why. Identifies unanchored regex, short atoms, expensive calculations.</p>
                    <div class="example">"This rule causes performance issues, why?"</div>
                </div>
            </div>
        </div>

        <div class="box">
            <div class="box-header">EMBEDDED_EXPERTISE</div>
            <div class="box-content">
                <p style="color: var(--fg-dim); margin-bottom: 1rem;">Three authoritative sources packaged into your agent's context:</p>
                
                <div class="feature-grid">
                    <div class="feature-item">
                        <h4>20+ Quality Checks</h4>
                        <p>Logic errors, performance issues, style violations via embedded yaraQA</p>
                    </div>
                    <div class="feature-item">
                        <h4>Performance Guide</h4>
                        <p>Atom selection, regex anchoring, condition ordering</p>
                    </div>
                    <div class="feature-item">
                        <h4>Style Standards</h4>
                        <p>Naming conventions (MAL, HKTL, SUSP, EXPL), metadata requirements</p>
                    </div>
                    <div class="feature-item">
                        <h4>Rule Patterns</h4>
                        <p>$x*, $s*, $a*, $fp* string naming pattern</p>
                    </div>
                </div>
            </div>
        </div>

        <div class="box">
            <div class="box-header">QUALITY_CHECKS</div>
            <div class="box-content">
                <p style="color: var(--fg-dim); margin-bottom: 1rem;">All 20+ yaraQA checks from embedded knowledge:</p>
                
                <h4 class="section-subtitle">Logic Errors</h4>
                <ul class="check-list">
                    <li class="check-item">
                        <span class="check-tag tag-logic">CE1</span>
                        <span class="check-desc">Conditions that never match (e.g., <code>2 of them</code> with only 1 string)</span>
                    </li>
                    <li class="check-item">
                        <span class="check-tag tag-logic">SM2-6</span>
                        <span class="check-desc">Modifier misuse (PDB with <code>wide</code>, paths with <code>fullword</code>)</span>
                    </li>
                    <li class="check-item">
                        <span class="check-tag tag-logic">CS1</span>
                        <span class="check-desc">String is substring of another (redundant)</span>
                    </li>
                </ul>

                <h4 class="section-subtitle">Performance Issues</h4>
                <ul class="check-list">
                    <li class="check-item">
                        <span class="check-tag tag-perf">PA1-2</span>
                        <span class="check-desc">Short atoms (&lt; 4 bytes) causing slow scans</span>
                    </li>
                    <li class="check-item">
                        <span class="check-tag tag-perf">RE1</span>
                        <span class="check-desc">Regex without 4+ byte anchors</span>
                    </li>
                    <li class="check-item">
                        <span class="check-tag tag-perf">CF1-2</span>
                        <span class="check-desc">Expensive calculations in wrong order</span>
                    </li>
                </ul>

                <h4 class="section-subtitle">Style & Resources</h4>
                <ul class="check-list">
                    <li class="check-item">
                        <span class="check-tag tag-style">SV1-2</span>
                        <span class="check-desc">Repeating chars, hex strings that should be text</span>
                    </li>
                    <li class="check-item">
                        <span class="check-tag tag-res">HS1-4</span>
                        <span class="check-desc">Too many strings or regex patterns</span>
                    </li>
                </ul>
            </div>
        </div>

        <div class="box">
            <div class="box-header">EXAMPLE_CONVERSATIONS</div>
            <div class="box-content">
                <p style="color: var(--fg-dim); margin-bottom: 1rem;">You paste a rule. The skill responds with specific issues:</p>
                
                <h4 class="section-subtitle">Example 1: Performance Disaster</h4>
                <pre><code><span class="comment">// CATASTROPHIC PERFORMANCE - no regex anchor</span>
<span class="keyword">rule</span> Big_Numbers0
{
<span class="keyword">    meta</span>:
        author = <span class="string">"_pusher_"</span>
<span class="keyword">    strings</span>:
        <span class="variable">$c0</span> = <span class="string">/[0-9a-fA-F]{20}/</span> fullword ascii
<span class="keyword">    condition</span>:
        <span class="variable">$c0</span>
}</code></pre>
                <div class="issue">
                    <strong>Issue RE1</strong>: No fixed anchor. YARA cannot extract 4-byte atom, forces naïve matching at every offset. Catastrophic performance.
                </div>
                <div class="fix">
                    <strong>Fix</strong>: Add context: <code>/hash[=:][0-9a-fA-F]{20}/</code>
                </div>

                <h4 class="section-subtitle">Example 2: Style Issues</h4>
                <pre><code><span class="comment">// Multiple style issues</span>
<span class="keyword">rule</span> MyRule
{
<span class="keyword">    meta</span>:
        description = <span class="string">"Detects malware"</span>
<span class="keyword">    strings</span>:
        <span class="variable">$a</span> = <span class="string">"MZ"</span>
        <span class="variable">$b</span> = { 41 4c 41 52 4d }
<span class="keyword">    condition</span>:
        <span class="variable">$a</span> at 0
}</code></pre>
                <div class="issue">
                    <strong>Issue SV2</strong>: Hex string can be text: <code>"ALARM"</code> instead of bytes
                </div>
                <div class="issue">
                    <strong>Issue PA1</strong>: Short string at position. Use <code>uint16(0) == 0x5A4D</code>
                </div>

                <h4 class="section-subtitle">Example 3: Logic Error</h4>
                <pre><code><span class="comment">// Syntactically correct but dysfunctional</span>
<span class="keyword">rule</span> HKTL_Mimikatz
{
<span class="keyword">    strings</span>:
        <span class="variable">$x1</span> = <span class="string">"\LsaDump.exe"</span> fullword
<span class="keyword">    condition</span>:
        <span class="variable">$x1</span>
}</code></pre>
                <div class="issue">
                    <strong>Issue SM4</strong>: String starts with <code>\</code> but uses <code>fullword</code>. Will NEVER match actual paths like <code>C:\Windows\LsaDump.exe</code>.
                </div>
                <div class="fix">
                    <strong>Fix</strong>: Remove <code>fullword</code>: <code>$x1 = "\LsaDump.exe"</code>
                </div>
            </div>
        </div>

        <div class="box">
            <div class="box-header">INSTALL</div>
            <div class="box-content">
                <p style="color: var(--fg-dim); margin-bottom: 1rem;">Add the skill to your LLM agent's context:</p>
                
                <div class="install-command">
                    <span class="comment prompt"># Download</span><br>
                    <span class="prompt">curl -L -o yara-rule-skill.skill \</span><br>
                    &nbsp;&nbsp;<span class="string">https://github.com/YARAHQ/yara-rule-skill/releases/latest/download/yara-rule-skill.skill</span><br><br>
                    <span class="comment prompt"># Add to skills folder (location varies)</span><br>
                    <span class="prompt">cp yara-rule-skill.skill ~/.openclaw/skills/</span>
                </div>
                
                <p style="color: var(--fg-dim);">Then start a conversation about YARA rules.</p>
                
                <p style="margin-top: 1rem;">
                    <a href="https://github.com/YARAHQ/yara-rule-skill">View on GitHub</a>
                    <a href="https://github.com/YARAHQ/yara-rule-skill/releases" style="margin-left: 1rem;">Download</a>
                </p>
            </div>
        </div>

        <footer>
            <p>Part of <a href="https://github.com/YARAHQ">YARA_HQ</a> — Community tools for YARA excellence</p>
            <p>Based on work by <a href="https://github.com/Neo23x0">Florian_Roth</a> (YARA-Performance-Guidelines, YARA-Style-Guide, yaraQA)</p>
        </footer>
    </div>
</body>
</html>
